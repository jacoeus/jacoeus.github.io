<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta name="google-site-verification" content="1he7C7Wt3l_3CNQSu4T8-ZTZacFv5BWFyxQZs38IW7I"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"jacoeus.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="最近尝试对分布式数据库进行学习，才了解到目前的主流分布式事务型数据库，其底层也是基于LSM树的 于是为了探究LSM树如何实现分布式以及如何实现事务控制，开始从单机场景的LevelDB，到支持分布式结构化数据表的BigTable，再到支持分布式事务的Spanner（NewSQL），以及在Spanner基础上增加列式存储支持的TiDB（HTAP）进行一系列基本的学习和整理"><meta property="og:type" content="article"><meta property="og:title" content="分布式数据库技术整理"><meta property="og:url" content="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/index.html"><meta property="og:site_name" content="JacoeusのBlog"><meta property="og:description" content="最近尝试对分布式数据库进行学习，才了解到目前的主流分布式事务型数据库，其底层也是基于LSM树的 于是为了探究LSM树如何实现分布式以及如何实现事务控制，开始从单机场景的LevelDB，到支持分布式结构化数据表的BigTable，再到支持分布式事务的Spanner（NewSQL），以及在Spanner基础上增加列式存储支持的TiDB（HTAP）进行一系列基本的学习和整理"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/1.png"><meta property="og:image" content="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/2.png"><meta property="article:published_time" content="2022-08-22T08:26:00.000Z"><meta property="article:modified_time" content="2022-08-23T17:57:33.460Z"><meta property="article:author" content="tang ziyin"><meta property="article:tag" content="分布式数据库"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/1.png"><link rel="canonical" href="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>分布式数据库技术整理 | JacoeusのBlog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">JacoeusのBlog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Hello World</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友链"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="tang ziyin"><meta itemprop="description" content="Awake, arise or be for ever fall&#39;n"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="JacoeusのBlog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">分布式数据库技术整理</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-08-22 16:26:00" itemprop="dateCreated datePublished" datetime="2022-08-22T16:26:00+08:00">2022-08-22</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-08-24 01:57:33" itemprop="dateModified" datetime="2022-08-24T01:57:33+08:00">2022-08-24</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Bigdata/" itemprop="url" rel="index"><span itemprop="name">Bigdata</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>4.8k</span></span></div></header><div class="post-body" itemprop="articleBody"><p>最近尝试对分布式数据库进行学习，才了解到目前的主流分布式事务型数据库，其底层也是基于LSM树的</p><p>于是为了探究LSM树如何实现分布式以及如何实现事务控制，开始从单机场景的<strong>LevelDB</strong>，到支持分布式结构化数据表的<strong>BigTable</strong>，再到支持分布式事务的<strong>Spanner</strong>（NewSQL），以及在Spanner基础上增加列式存储支持的<strong>TiDB</strong>（HTAP）进行一系列基本的学习和整理</p><a id="more"></a><h1 id="LSM-Tree"><a href="#LSM-Tree" class="headerlink" title="LSM Tree"></a>LSM Tree</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/181498475">LSM树详解 - 知乎 (zhihu.com)</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/408611925">LSM核心实现讲解 - 知乎 (zhihu.com)</a></p><p>LSM tree 是许多key-value型或日志型数据库所依赖的核心数据结构，例如 BigTable、HBase、LevelDB、RocksDB等</p><p>LSM树的核心特点是利用顺序写来提高写性能，通过牺牲小部分读性能换来高性能写。考虑到磁盘或内存的连续读写性能远高于随机读写性能，使LSM树成为非常流行的存储结构</p><ul><li>写入（批量）：LSM树通过将写入数据（Key-Value键值）首先存储在内存中，在数据量达到一定的阈值后将内存中的所有数据按Key值排序形成SSTable(Sorted String Table)的结构写入磁盘</li><li>WAL(Write-ahead logging，预写式日志)：为了防止数据在内存中因为宕机等原因丢失数据，在写入内存的同时预写进日志并落盘，来保证数据的可靠性。</li><li>读取（随机）：对磁盘中的SSTable逐个查询，查找当前读的Key是否存在与该SSTable（可以通过索引/布隆过滤器来优化查找速度），有则根据SSTable对应的跳表或者红黑树结构查找对应的Value（一般维护一个稀疏索引来记录部分Key的在SSTable文件中的offset）</li><li>合并：对于某个Key，在完成多次更新操作后，除了最新的那条记录外，其他的记录都是冗余无用的，但是仍然占用了存储空间。因此需要进行Compact操作(合并多个SSTable)来清除冗余的记录，另外因为SSTable是有序的，可以通过归并的方式对多个SSTable进行合并</li></ul><p>与另一个经典的B+树相比，巧妙的避免了在磁盘进行随机写的情况，但也导致无法通过随机读写完成更新删除操作，需要额外的开销来进行处理（读写放大问题）</p><p>PS：B+树中数据在磁盘以表的形式存储，LSM树一般以Key-Value键值对为基础进行储存</p><h2 id="LevelDB"><a href="#LevelDB" class="headerlink" title="LevelDB"></a>LevelDB</h2><p><a target="_blank" rel="noopener" href="https://github.com/google/leveldb">google/leveldb: LevelDB is a fast key-value storage library written at Google that provides an ordered mapping from string keys to string values. (github.com)</a></p><p>LevelDB应该时对LSM树一个经典的实现方案，核心在于对SSTable以层次结构，逐Level归并将大量SSTable合并成少量SSTable，从而降低文件数量、提高搜索效率同时及时剔除过期数据，降低磁盘占用</p><ul><li>Memtable在内存中使用跳表存储数据，维护一个有序的Key序列</li><li>Memtable在达到容量上限后转换成Immutable Memtable，准备写入磁盘</li><li>在磁盘上以SSTable(Sorted String Table)的形式存储数据，同时在SSTable数量达到一定程度时可以通过Compact操作将多个SSTable合并成少量SSTable</li><li>合并过程以层级结构进行提现，每次合并层级+1</li><li>Manifest文件记录各个SST层级以及Key的范围(读操作时首先根据此处记录的Key范围进行判断)</li><li>不同于es，会对内存中的Memtable进行查询，即支持实时读</li></ul><h2 id="BigTable"><a href="#BigTable" class="headerlink" title="BigTable"></a>BigTable</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/150266419">理解 BigTable - 知乎 (zhihu.com)</a></p><p>Google经典的三篇论文之一，提供了一种分布式结构化数据表方案。</p><ul><li>设计Chubby负责元数据存储和主服务器选择</li><li>主服务器负责子表服务器的管理和子表分配</li><li>使用SSTable作为数据存储格式，存储在GFS上，基于键进行查询</li><li>存储逻辑可以表示为(row:string, column:string, time:int64)→string，通过这样将结构化数据表表达为key-value的形式进行存储</li></ul><h2 id="HBase"><a href="#HBase" class="headerlink" title="HBase"></a>HBase</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/159052841">https://zhuanlan.zhihu.com/p/159052841</a></p><p>HBase是BigTable的一种实现，是Hadoop生态下核心技术之一</p><blockquote><p>PS：有些地方将HBase的数据模型表达为列式存储，但这跟OLAP的列式存储不是一个概念，可以理解为介于行式和列式之间的面向列族的存储模型</p></blockquote><p>HBase数据存储结构中主要包括：表、行、列族、列限定符、单元格和时间戳，读写操作主要依赖于行键RowKey</p><p>整个数据时按照RowKey进行字典排序的，而相同RowKey的数据以(列族, 类限定符)作为Key来定位Value，于是相同一行的数据中列族相同的数据是顺序存放的，此为<em>column-oriented</em>，不同于将不同行同一列顺序存放的列式存储</p><p>HBase由三种类型的服务器以主从模式构成：</p><ul><li>Region Server：负责数据的读写服务，用户通过与Region server交互来实现对数据的访问</li><li>HBase HMaster：负责Region的分配及数据库的创建和删除等操作</li><li>ZooKeeper：负责维护集群的状态（某台服务器是否在线，服务器之间数据的同步操作及master的选举等）</li></ul><h2 id="Spanner"><a href="#Spanner" class="headerlink" title="Spanner"></a>Spanner</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/85616742">解读Google Spanner - 知乎 (zhihu.com)</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/47504853">使用 KV 引擎存储结构化数据 - 知乎 (zhihu.com)</a></p><p>考虑到BigTable在应用中仍然存在一些问题</p><ol><li>缺少类似SQL的界面，缺少关系数据库拥有的丰富的功能</li><li>只支持单行事务，缺少跨行事务</li><li>需要在跨数据中心的多个副本间保证一致性</li></ol><blockquote><p>Spanner是Google公开的新一代分布式数据库，它既具有NoSQL系统的可扩展性，也具有关系数据库的功能。例如，它支持类似SQL的查询语言、表连接以及分布式事务</p></blockquote><ul><li>采用了Megastore的数据模型，Chubby的数据复制和一致性算法，同时基于BigTable提供可扩展性</li><li>使用高精度和可观测误差的本地时钟来判断分布式系统中事件的先后顺序，从而保证事务一致性</li></ul><p><strong>数据模型</strong></p><p>Spanner继承了Megastore的设计，数据模型介于RDBMS和NoSQL之间，提供<strong>树形</strong>、<strong>层次化</strong>的数据库schema</p><ul><li>一方面支持类SQL的查询语言，提供表连接等关系数据库的特性，功能上类似于RDBMS</li><li>一方面整个数据库中的所有记录都存储在同一个key-value大表中，实现上类似于BigTable</li></ul><p>Spanner通过将父表的主键作为子表主键的前缀来反映表之间的层次关系（一对多），并且将根节点表中的一条记录，和以其主键作为前缀的其他表中的所有记录的集合称作一个Directory，作为分区、 复制和迁移的基本单位</p><p><strong>一致性</strong></p><p>Spanner使用Paxos协议在多个副本间同步redo日志，从而保证数据在多个副本上是一致的</p><p><strong>分布式事务</strong></p><p>Spanner 系统中的分布式事务通过<strong>两阶段提交协议2PC</strong>实现。2PC可以保证当一个分布式事务涉及了多个数据节点时，在这些节点上的操作要么全部提交，要么全部失败，进而保证整个分布式事务的原子性（ACID里的A）。</p><p>协议中包含两个角色：协调者coordinator和参与者participant/cohort。协调者是分布式事务的发起者，而参与者是参与了事务的数据节点，大致流程如下</p><ol><li><p>协调者向所有的参与者发送投票请求，每个参与者决定是否要提交事务。如果打算提交的话需要写好redo、undo等日志，并向协调者回复yes或no</p></li><li><p>协调者收到所有参与者的回复，如果都是yes，那么决定提交这个事务，写好日志后向所有参与者广播提交事务的通知。反之，则中止事务并且通知所有参与者</p></li></ol><p>除了保证一致性以外，分布式事务的另一个问题是需要保证事务间执行的顺序性，这固然可以通过多次通信来进行保证，但Spanner提出了另一种解决方案，即借助时间来判断先后顺序</p><blockquote><p>TrueTime API是一个提供本地时间的接口，可以返回一个时间戳t，并给出一个误差ε</p></blockquote><p>Spanner通过TrueTime API在保证误差范围内上一个事务已经确保完成且不会与下一个事务重叠时才对上一个事务进行提交</p><h2 id="TiDB"><a href="#TiDB" class="headerlink" title="TiDB"></a>TiDB</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/494715695">https://zhuanlan.zhihu.com/p/494715695</a></p><p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/802291#slide-4">https://developer.aliyun.com/article/802291#slide-4</a></p><blockquote><p>TiDB是一个开源的NewSQL数据库，支持HTAP（Hybrid Transactional and Analytical Processing），既支持事务型操作，也支持数据分析</p></blockquote><p>TiDB包括3个核心组件：分布存储层，Placement Driver，计算引擎层</p><ul><li><p>存储层分为行存的TiKV和列存的TiFlash</p><p><img src="1.png" alt="1"></p><ul><li><p>把key值按照range分区，每个分区称为一个<strong>Region</strong>，而每个Region对应一个Raft Group，对应有且仅有一个leader，多个follwer，leader异步的将log同步给TiFlash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Key:&#123;table&#123;tableID&#125; record&#123;rowID&#125;&#125;</span><br><span class="line">Value: &#123;col0, col1, col2, col3&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>TiKV</strong>通过multi-Raft算法实现行存引擎，处理TP的更新和查询</p></li><li><p><strong>TiFlash</strong>通过给Raft算法增加learner角色，异步地从leader同步log到列存引擎TiFlash，把行存格式转成列存</p></li></ul></li><li><p><strong>Placement Driver</strong>负责维护Region，包括记录元数据，对region进行迁移以实现负载均衡，以及分发timestamp，提供严格递增且全局唯一的timestamp作为事务ID（不同于Spanneer，需要额外的通信开销）</p></li><li><p>SQL引擎层是无状态化可扩展的，可以根据SQL语句动态的选择基于哪个存储引擎操作数据</p></li></ul><p>其中TiDB中每个组件满足高可用和扩展性，并且TiDB还适配了Spark，集成TiDB的数据和HDFS生态</p><p><strong>TiKV</strong></p><ul><li>TiKV是对Spanner的一个开源实现，且底层本地存储依赖于RocksDB</li><li>TiKV的MVCC 实现是通过在Key后面添加版本号来实现</li></ul><p><strong>TiFlash</strong></p><p>TiFlash使用<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/164490310">DeltaTree</a>作为其列存引擎来支持实时更新</p><p><img src="2.png" alt="2"></p><p>其中，对表数据按照主键进行range分区，并建立B+树，树的叶子节点，即切分后的数据块称为Segment，并在其内部采用了类似LSM Tree的分层结构（分为Delta层和Stable层），这样通过Segment分区降低区内数据量，可以减少LSM Tree的层数，减少读写放大</p><p>更新数据加入后，先根据主键索引在B+树中找到对应的Segment，作为增量更新进行写入，待该Segment在内存中写满后刷入磁盘的Delta层，之后Delta层通过与Stable层进行合并（Delta Merge）得到更新后的Stable层</p><p><strong>列式存储</strong></p><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1528525">数据库中的 “行式存储”和“列式存储” - 腾讯云开发者社区-腾讯云 (tencent.com)</a></p><p>列式存储能极大提升查询效率和一定程度上提高物理存储利用率，因此适用于海量静态数据的分析场景中</p><p>1、查询过程中，可针对各列的运算<strong>并发执行</strong>，在内存中聚合完整记录集，从而提升查询效率</p><p>2、可在数据列中高效查找数据，无需维护索引，减少无关IO，避免全表扫描</p><p>3、各列独立存储且数据类型相同，可以针对该列的数据类型以及数据量动态选择压缩算法，提高物理存储利用率</p><h1 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/452628664">投资数据库领域：2021年总结（OLTP、OLAP、streaming） - 知乎 (zhihu.com)</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/54439354">Snowflake：数据仓库的终极形态？ - 知乎 (zhihu.com)</a></p></div><div class="reward-container"><div></div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/alipay.jpg" alt="tang ziyin 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>tang ziyin</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://jacoeus.github.io/2022/08/22/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%95%B4%E7%90%86/" title="分布式数据库技术整理">https://jacoeus.github.io/2022/08/22/分布式数据库技术整理/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 分布式数据库</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2021/12/31/Spark%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" rel="prev" title="Spark日志分析算法实现"><i class="fa fa-chevron-left"></i> Spark日志分析算法实现</a></div><div class="post-nav-item"><a href="/2022/08/22/Elasticsearch%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/" rel="next" title="Elasticsearch源码阅读">Elasticsearch源码阅读 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#LSM-Tree"><span class="nav-number">1.</span> <span class="nav-text">LSM Tree</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LevelDB"><span class="nav-number">1.1.</span> <span class="nav-text">LevelDB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BigTable"><span class="nav-number">1.2.</span> <span class="nav-text">BigTable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HBase"><span class="nav-number">1.3.</span> <span class="nav-text">HBase</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spanner"><span class="nav-number">1.4.</span> <span class="nav-text">Spanner</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TiDB"><span class="nav-number">1.5.</span> <span class="nav-text">TiDB</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PS"><span class="nav-number">2.</span> <span class="nav-text">PS</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/"><img class="site-author-image" itemprop="image" alt="tang ziyin" src="/images/avatar.jpg"></a><p class="site-author-name" itemprop="name">tang ziyin</p><div class="site-description" itemprop="description">Awake, arise or be for ever fall&#39;n</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">10</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/jacoeus" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jacoeus" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:jacoeus@qq.com" title="E-Mail → mailto:jacoeus@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">tang ziyin</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">93k</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/valine/1.3.10/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'iogdw17Nj7hJHEGAgwRDUDrW-gzGzoHsz',
      appKey     : 'dVrERgoAN8k3ElI9ISHu1itV',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});</script></body></html>